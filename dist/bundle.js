(function(re,ne){typeof exports=="object"&&typeof module<"u"?module.exports=ne():typeof define=="function"&&define.amd?define(ne):(re=typeof globalThis<"u"?globalThis:re||self,re.Undo=ne())})(this,function(){"use strict";var bi=Object.defineProperty;var Oi=(re,ne,Re)=>ne in re?bi(re,ne,{enumerable:!0,configurable:!0,writable:!0,value:Re}):re[ne]=Re;var X=(re,ne,Re)=>Oi(re,typeof ne!="symbol"?ne+"":ne,Re);var re=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ne(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Re(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var r=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(n).forEach(function(o){var t=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(r,o,t.get?t:{enumerable:!0,get:function(){return n[o]}})}),r}var Ve,Vt;function Jt(){if(Vt)return Ve;Vt=1;var n=Object.prototype.toString;return Ve=function(r){var o=n.call(r),t=o==="[object Arguments]";return t||(t=o!=="[object Array]"&&r!==null&&typeof r=="object"&&typeof r.length=="number"&&r.length>=0&&n.call(r.callee)==="[object Function]"),t},Ve}var Je,Yt;function va(){if(Yt)return Je;Yt=1;var n;if(!Object.keys){var e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=Jt(),t=Object.prototype.propertyIsEnumerable,i=!t.call({toString:null},"toString"),u=t.call(function(){},"prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(y){var g=y.constructor;return g&&g.prototype===y},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},v=function(){if(typeof window>"u")return!1;for(var y in window)try{if(!c["$"+y]&&e.call(window,y)&&window[y]!==null&&typeof window[y]=="object")try{f(window[y])}catch{return!0}}catch{return!0}return!1}(),p=function(y){if(typeof window>"u"||!v)return f(y);try{return f(y)}catch{return!1}};n=function(g){var S=g!==null&&typeof g=="object",R=r.call(g)==="[object Function]",d=o(g),O=S&&r.call(g)==="[object String]",w=[];if(!S&&!R&&!d)throw new TypeError("Object.keys called on a non-object");var b=u&&R;if(O&&g.length>0&&!e.call(g,0))for(var M=0;M<g.length;++M)w.push(String(M));if(d&&g.length>0)for(var Q=0;Q<g.length;++Q)w.push(String(Q));else for(var G in g)!(b&&G==="prototype")&&e.call(g,G)&&w.push(String(G));if(i)for(var D=p(g),k=0;k<a.length;++k)!(D&&a[k]==="constructor")&&e.call(g,a[k])&&w.push(a[k]);return w}}return Je=n,Je}var Ye,Xt;function Xe(){if(Xt)return Ye;Xt=1;var n=Array.prototype.slice,e=Jt(),r=Object.keys,o=r?function(u){return r(u)}:va(),t=Object.keys;return o.shim=function(){if(Object.keys){var u=function(){var a=Object.keys(arguments);return a&&a.length===arguments.length}(1,2);u||(Object.keys=function(f){return e(f)?t(n.call(f)):t(f)})}else Object.keys=o;return Object.keys||o},Ye=o,Ye}var Ze,Zt;function _e(){if(Zt)return Ze;Zt=1;var n=Object.defineProperty||!1;if(n)try{n({},"a",{value:1})}catch{n=!1}return Ze=n,Ze}var Qe,Qt;function er(){return Qt||(Qt=1,Qe=SyntaxError),Qe}var rr,en;function ae(){return en||(en=1,rr=TypeError),rr}var tr,rn;function ha(){return rn||(rn=1,tr=Object.getOwnPropertyDescriptor),tr}var nr,tn;function be(){if(tn)return nr;tn=1;var n=ha();if(n)try{n([],"length")}catch{n=null}return nr=n,nr}var or,nn;function ar(){if(nn)return or;nn=1;var n=_e(),e=er(),r=ae(),o=be();return or=function(i,u,a){if(!i||typeof i!="object"&&typeof i!="function")throw new r("`obj` must be an object or a function`");if(typeof u!="string"&&typeof u!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var f=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,v=arguments.length>5?arguments[5]:null,p=arguments.length>6?arguments[6]:!1,y=!!o&&o(i,u);if(n)n(i,u,{configurable:v===null&&y?y.configurable:!v,enumerable:f===null&&y?y.enumerable:!f,value:a,writable:c===null&&y?y.writable:!c});else if(p||!f&&!c&&!v)i[u]=a;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},or}var ir,on;function ur(){if(on)return ir;on=1;var n=_e(),e=function(){return!!n};return e.hasArrayLengthDefineBug=function(){if(!n)return null;try{return n([],"length",{value:1}).length!==1}catch{return!0}},ir=e,ir}var fr,an;function Oe(){if(an)return fr;an=1;var n=Xe(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",r=Object.prototype.toString,o=Array.prototype.concat,t=ar(),i=function(c){return typeof c=="function"&&r.call(c)==="[object Function]"},u=ur()(),a=function(c,v,p,y){if(v in c){if(y===!0){if(c[v]===p)return}else if(!i(y)||!y())return}u?t(c,v,p,!0):t(c,v,p)},f=function(c,v){var p=arguments.length>2?arguments[2]:{},y=n(v);e&&(y=o.call(y,Object.getOwnPropertySymbols(v)));for(var g=0;g<y.length;g+=1)a(c,y[g],v[y[g]],p[y[g]])};return f.supportsDescriptors=!!u,fr=f,fr}var sr={exports:{}},lr,un;function cr(){return un||(un=1,lr=Object),lr}var pr,fn;function sn(){return fn||(fn=1,pr=Error),pr}var yr,ln;function da(){return ln||(ln=1,yr=EvalError),yr}var vr,cn;function ga(){return cn||(cn=1,vr=RangeError),vr}var hr,pn;function ma(){return pn||(pn=1,hr=ReferenceError),hr}var dr,yn;function Sa(){return yn||(yn=1,dr=URIError),dr}var gr,vn;function ba(){return vn||(vn=1,gr=Math.abs),gr}var mr,hn;function Oa(){return hn||(hn=1,mr=Math.floor),mr}var Sr,dn;function Aa(){return dn||(dn=1,Sr=Math.max),Sr}var br,gn;function wa(){return gn||(gn=1,br=Math.min),br}var Or,mn;function Pa(){return mn||(mn=1,Or=Math.pow),Or}var Ar,Sn;function Ia(){return Sn||(Sn=1,Ar=Math.round),Ar}var wr,bn;function qa(){return bn||(bn=1,wr=Number.isNaN||function(e){return e!==e}),wr}var Pr,On;function Ra(){if(On)return Pr;On=1;var n=qa();return Pr=function(r){return n(r)||r===0?r:r<0?-1:1},Pr}var Ir,An;function Fe(){return An||(An=1,Ir=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),o=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(o)!=="[object Symbol]")return!1;var t=42;e[r]=t;for(var i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var u=Object.getOwnPropertySymbols(e);if(u.length!==1||u[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==t||a.enumerable!==!0)return!1}return!0}),Ir}var qr,wn;function Rr(){if(wn)return qr;wn=1;var n=typeof Symbol<"u"&&Symbol,e=Fe();return qr=function(){return typeof n!="function"||typeof Symbol!="function"||typeof n("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},qr}var Er,Pn;function In(){return Pn||(Pn=1,Er=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Er}var $r,qn;function Rn(){if(qn)return $r;qn=1;var n=cr();return $r=n.getPrototypeOf||null,$r}var Br,En;function Ea(){if(En)return Br;En=1;var n="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,r=Math.max,o="[object Function]",t=function(f,c){for(var v=[],p=0;p<f.length;p+=1)v[p]=f[p];for(var y=0;y<c.length;y+=1)v[y+f.length]=c[y];return v},i=function(f,c){for(var v=[],p=c,y=0;p<f.length;p+=1,y+=1)v[y]=f[p];return v},u=function(a,f){for(var c="",v=0;v<a.length;v+=1)c+=a[v],v+1<a.length&&(c+=f);return c};return Br=function(f){var c=this;if(typeof c!="function"||e.apply(c)!==o)throw new TypeError(n+c);for(var v=i(arguments,1),p,y=function(){if(this instanceof p){var O=c.apply(this,t(v,arguments));return Object(O)===O?O:this}return c.apply(f,t(v,arguments))},g=r(0,c.length-v.length),S=[],R=0;R<g;R++)S[R]="$"+R;if(p=Function("binder","return function ("+u(S,",")+"){ return binder.apply(this,arguments); }")(y),c.prototype){var d=function(){};d.prototype=c.prototype,p.prototype=new d,d.prototype=null}return p},Br}var xr,$n;function je(){if($n)return xr;$n=1;var n=Ea();return xr=Function.prototype.bind||n,xr}var Tr,Bn;function Mr(){return Bn||(Bn=1,Tr=Function.prototype.call),Tr}var jr,xn;function Cr(){return xn||(xn=1,jr=Function.prototype.apply),jr}var kr,Tn;function $a(){return Tn||(Tn=1,kr=typeof Reflect<"u"&&Reflect&&Reflect.apply),kr}var Dr,Mn;function jn(){if(Mn)return Dr;Mn=1;var n=je(),e=Cr(),r=Mr(),o=$a();return Dr=o||n.call(r,e),Dr}var _r,Cn;function Fr(){if(Cn)return _r;Cn=1;var n=je(),e=ae(),r=Mr(),o=jn();return _r=function(i){if(i.length<1||typeof i[0]!="function")throw new e("a function is required");return o(n,r,i)},_r}var Nr,kn;function Ba(){if(kn)return Nr;kn=1;var n=Fr(),e=be(),r;try{r=[].__proto__===Array.prototype}catch(u){if(!u||typeof u!="object"||!("code"in u)||u.code!=="ERR_PROTO_ACCESS")throw u}var o=!!r&&e&&e(Object.prototype,"__proto__"),t=Object,i=t.getPrototypeOf;return Nr=o&&typeof o.get=="function"?n([o.get]):typeof i=="function"?function(a){return i(a==null?a:t(a))}:!1,Nr}var Wr,Dn;function _n(){if(Dn)return Wr;Dn=1;var n=In(),e=Rn(),r=Ba();return Wr=n?function(t){return n(t)}:e?function(t){if(!t||typeof t!="object"&&typeof t!="function")throw new TypeError("getProto: not an object");return e(t)}:r?function(t){return r(t)}:null,Wr}var Lr,Fn;function Ur(){if(Fn)return Lr;Fn=1;var n=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=je();return Lr=r.call(n,e),Lr}var Hr,Nn;function le(){if(Nn)return Hr;Nn=1;var n,e=cr(),r=sn(),o=da(),t=ga(),i=ma(),u=er(),a=ae(),f=Sa(),c=ba(),v=Oa(),p=Aa(),y=wa(),g=Pa(),S=Ia(),R=Ra(),d=Function,O=function(j){try{return d('"use strict"; return ('+j+").constructor;")()}catch{}},w=be(),b=_e(),M=function(){throw new a},Q=w?function(){try{return arguments.callee,M}catch{try{return w(arguments,"callee").get}catch{return M}}}():M,G=Rr()(),D=_n(),k=Rn(),I=In(),_=Cr(),U=Mr(),N={},H=typeof Uint8Array>"u"||!D?n:D(Uint8Array),V={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?n:ArrayBuffer,"%ArrayIteratorPrototype%":G&&D?D([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":N,"%AsyncGenerator%":N,"%AsyncGeneratorFunction%":N,"%AsyncIteratorPrototype%":N,"%Atomics%":typeof Atomics>"u"?n:Atomics,"%BigInt%":typeof BigInt>"u"?n:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?n:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":o,"%Float32Array%":typeof Float32Array>"u"?n:Float32Array,"%Float64Array%":typeof Float64Array>"u"?n:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?n:FinalizationRegistry,"%Function%":d,"%GeneratorFunction%":N,"%Int8Array%":typeof Int8Array>"u"?n:Int8Array,"%Int16Array%":typeof Int16Array>"u"?n:Int16Array,"%Int32Array%":typeof Int32Array>"u"?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":G&&D?D(D([][Symbol.iterator]())):n,"%JSON%":typeof JSON=="object"?JSON:n,"%Map%":typeof Map>"u"?n:Map,"%MapIteratorPrototype%":typeof Map>"u"||!G||!D?n:D(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":w,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?n:Promise,"%Proxy%":typeof Proxy>"u"?n:Proxy,"%RangeError%":t,"%ReferenceError%":i,"%Reflect%":typeof Reflect>"u"?n:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?n:Set,"%SetIteratorPrototype%":typeof Set>"u"||!G||!D?n:D(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":G&&D?D(""[Symbol.iterator]()):n,"%Symbol%":G?Symbol:n,"%SyntaxError%":u,"%ThrowTypeError%":Q,"%TypedArray%":H,"%TypeError%":a,"%Uint8Array%":typeof Uint8Array>"u"?n:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?n:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?n:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?n:Uint32Array,"%URIError%":f,"%WeakMap%":typeof WeakMap>"u"?n:WeakMap,"%WeakRef%":typeof WeakRef>"u"?n:WeakRef,"%WeakSet%":typeof WeakSet>"u"?n:WeakSet,"%Function.prototype.call%":U,"%Function.prototype.apply%":_,"%Object.defineProperty%":b,"%Object.getPrototypeOf%":k,"%Math.abs%":c,"%Math.floor%":v,"%Math.max%":p,"%Math.min%":y,"%Math.pow%":g,"%Math.round%":S,"%Math.sign%":R,"%Reflect.getPrototypeOf%":I};if(D)try{null.error}catch(j){var K=D(D(j));V["%Error.prototype%"]=K}var $e=function j(P){var q;if(P==="%AsyncFunction%")q=O("async function () {}");else if(P==="%GeneratorFunction%")q=O("function* () {}");else if(P==="%AsyncGeneratorFunction%")q=O("async function* () {}");else if(P==="%AsyncGenerator%"){var A=j("%AsyncGeneratorFunction%");A&&(q=A.prototype)}else if(P==="%AsyncIteratorPrototype%"){var E=j("%AsyncGenerator%");E&&D&&(q=D(E.prototype))}return V[P]=q,q},we={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ie=je(),z=Ur(),Pe=ie.call(U,Array.prototype.concat),Be=ie.call(_,Array.prototype.splice),Ie=ie.call(U,String.prototype.replace),de=ie.call(U,String.prototype.slice),h=ie.call(U,RegExp.prototype.exec),m=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,T=/\\(\\)?/g,$=function(P){var q=de(P,0,1),A=de(P,-1);if(q==="%"&&A!=="%")throw new u("invalid intrinsic syntax, expected closing `%`");if(A==="%"&&q!=="%")throw new u("invalid intrinsic syntax, expected opening `%`");var E=[];return Ie(P,m,function(J,Y,F,ee){E[E.length]=F?Ie(ee,T,"$1"):Y||J}),E},B=function(P,q){var A=P,E;if(z(we,A)&&(E=we[A],A="%"+E[0]+"%"),z(V,A)){var J=V[A];if(J===N&&(J=$e(A)),typeof J>"u"&&!q)throw new a("intrinsic "+P+" exists, but is not available. Please file an issue!");return{alias:E,name:A,value:J}}throw new u("intrinsic "+P+" does not exist!")};return Hr=function(P,q){if(typeof P!="string"||P.length===0)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof q!="boolean")throw new a('"allowMissing" argument must be a boolean');if(h(/^%?[^%]*%?$/,P)===null)throw new u("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var A=$(P),E=A.length>0?A[0]:"",J=B("%"+E+"%",q),Y=J.name,F=J.value,ee=!1,ge=J.alias;ge&&(E=ge[0],Be(A,Pe([0,1],ge)));for(var fe=1,se=!0;fe<A.length;fe+=1){var te=A[fe],ce=de(te,0,1),pe=de(te,-1);if((ce==='"'||ce==="'"||ce==="`"||pe==='"'||pe==="'"||pe==="`")&&ce!==pe)throw new u("property names with quotes must have matching quotes");if((te==="constructor"||!se)&&(ee=!0),E+="."+te,Y="%"+E+"%",z(V,Y))F=V[Y];else if(F!=null){if(!(te in F)){if(!q)throw new a("base intrinsic for "+P+" exists, but the property is not available.");return}if(w&&fe+1>=A.length){var ye=w(F,te);se=!!ye,se&&"get"in ye&&!("originalValue"in ye.get)?F=ye.get:F=F[te]}else se=z(F,te),F=F[te];se&&!ee&&(V[Y]=F)}}return F},Hr}var Gr,Wn;function xa(){if(Wn)return Gr;Wn=1;var n=le(),e=ar(),r=ur()(),o=be(),t=ae(),i=n("%Math.floor%");return Gr=function(a,f){if(typeof a!="function")throw new t("`fn` is not a function");if(typeof f!="number"||f<0||f>4294967295||i(f)!==f)throw new t("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],v=!0,p=!0;if("length"in a&&o){var y=o(a,"length");y&&!y.configurable&&(v=!1),y&&!y.writable&&(p=!1)}return(v||p||!c)&&(r?e(a,"length",f,!0,!0):e(a,"length",f)),a},Gr}var Kr,Ln;function Ta(){if(Ln)return Kr;Ln=1;var n=je(),e=Cr(),r=jn();return Kr=function(){return r(n,e,arguments)},Kr}var Un;function Ee(){return Un||(Un=1,function(n){var e=xa(),r=_e(),o=Fr(),t=Ta();n.exports=function(u){var a=o(arguments),f=u.length-(arguments.length-1);return e(a,1+(f>0?f:0),!0)},r?r(n.exports,"apply",{value:t}):n.exports.apply=t}(sr)),sr.exports}var zr,Hn;function Z(){if(Hn)return zr;Hn=1;var n=le(),e=Fr(),r=e([n("%String.prototype.indexOf%")]);return zr=function(t,i){var u=n(t,!!i);return typeof u=="function"&&r(t,".prototype.")>-1?e([u]):u},zr}var Vr,Gn;function Kn(){if(Gn)return Vr;Gn=1;var n=Xe(),e=Fe()(),r=Z(),o=cr(),t=r("Array.prototype.push"),i=r("Object.prototype.propertyIsEnumerable"),u=e?o.getOwnPropertySymbols:null;return Vr=function(f,c){if(f==null)throw new TypeError("target must be an object");var v=o(f);if(arguments.length===1)return v;for(var p=1;p<arguments.length;++p){var y=o(arguments[p]),g=n(y),S=e&&(o.getOwnPropertySymbols||u);if(S)for(var R=S(y),d=0;d<R.length;++d){var O=R[d];i(y,O)&&t(g,O)}for(var w=0;w<g.length;++w){var b=g[w];if(i(y,b)){var M=y[b];v[b]=M}}}return v},Vr}var Jr,zn;function Vn(){if(zn)return Jr;zn=1;var n=Kn(),e=function(){if(!Object.assign)return!1;for(var o="abcdefghijklmnopqrst",t=o.split(""),i={},u=0;u<t.length;++u)i[t[u]]=t[u];var a=Object.assign({},i),f="";for(var c in a)f+=c;return o!==f},r=function(){if(!Object.assign||!Object.preventExtensions)return!1;var o=Object.preventExtensions({1:2});try{Object.assign(o,"xy")}catch{return o[1]==="y"}return!1};return Jr=function(){return!Object.assign||e()||r()?n:Object.assign},Jr}var Yr,Jn;function Ma(){if(Jn)return Yr;Jn=1;var n=Oe(),e=Vn();return Yr=function(){var o=e();return n(Object,{assign:o},{assign:function(){return Object.assign!==o}}),o},Yr}var Xr,Yn;function ja(){if(Yn)return Xr;Yn=1;var n=Oe(),e=Ee(),r=Kn(),o=Vn(),t=Ma(),i=e.apply(o()),u=function(f,c){return i(Object,arguments)};return n(u,{getPolyfill:o,implementation:r,shim:t}),Xr=u,Xr}var Zr,Xn;function Zn(){if(Xn)return Zr;Xn=1;var n=le(),e=Ee(),r=e(n("String.prototype.indexOf"));return Zr=function(t,i){var u=n(t,!!i);return typeof u=="function"&&r(t,".prototype.")>-1?e(u):u},Zr}var Qr,Qn;function Ca(){if(Qn)return Qr;Qn=1;var n=function(){return typeof(function(){}).name=="string"},e=Object.getOwnPropertyDescriptor;if(e)try{e([],"length")}catch{e=null}n.functionsHaveConfigurableNames=function(){if(!n()||!e)return!1;var t=e(function(){},"name");return!!t&&!!t.configurable};var r=Function.prototype.bind;return n.boundFunctionsHaveNames=function(){return n()&&typeof r=="function"&&(function(){}).bind().name!==""},Qr=n,Qr}var et,eo;function ka(){if(eo)return et;eo=1;var n=ar(),e=ur()(),r=Ca().functionsHaveConfigurableNames(),o=ae();return et=function(i,u){if(typeof i!="function")throw new o("`fn` is not a function");var a=arguments.length>2&&!!arguments[2];return(!a||r)&&(e?n(i,"name",u,!0,!0):n(i,"name",u)),i},et}var rt,ro;function to(){if(ro)return rt;ro=1;var n=ka(),e=ae(),r=Object;return rt=n(function(){if(this==null||this!==r(this))throw new e("RegExp.prototype.flags getter called on non-object");var t="";return this.hasIndices&&(t+="d"),this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.unicodeSets&&(t+="v"),this.sticky&&(t+="y"),t},"get flags",!0),rt}var tt,no;function oo(){if(no)return tt;no=1;var n=to(),e=Oe().supportsDescriptors,r=Object.getOwnPropertyDescriptor;return tt=function(){if(e&&/a/mig.flags==="gim"){var t=r(RegExp.prototype,"flags");if(t&&typeof t.get=="function"&&"dotAll"in RegExp.prototype&&"hasIndices"in RegExp.prototype){var i="",u={};if(Object.defineProperty(u,"hasIndices",{get:function(){i+="d"}}),Object.defineProperty(u,"sticky",{get:function(){i+="y"}}),t.get.call(u),i==="dy")return t.get}}return n},tt}var nt,ao;function Da(){if(ao)return nt;ao=1;var n=Oe().supportsDescriptors,e=oo(),r=be(),o=Object.defineProperty,t=sn(),i=_n(),u=/a/;return nt=function(){if(!n||!i)throw new t("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var f=e(),c=i(u),v=r(c,"flags");return(!v||v.get!==f)&&o(c,"flags",{configurable:!0,enumerable:!1,get:f}),f},nt}var ot,io;function _a(){if(io)return ot;io=1;var n=Oe(),e=Ee(),r=to(),o=oo(),t=Da(),i=e(o());return n(i,{getPolyfill:o,implementation:r,shim:t}),ot=i,ot}var Ce={exports:{}},at,uo;function Ae(){if(uo)return at;uo=1;var n=Fe();return at=function(){return n()&&!!Symbol.toStringTag},at}var it,fo;function so(){if(fo)return it;fo=1;var n=Ae()(),e=Z(),r=e("Object.prototype.toString"),o=function(a){return n&&a&&typeof a=="object"&&Symbol.toStringTag in a?!1:r(a)==="[object Arguments]"},t=function(a){return o(a)?!0:a!==null&&typeof a=="object"&&"length"in a&&typeof a.length=="number"&&a.length>=0&&r(a)!=="[object Array]"&&"callee"in a&&r(a.callee)==="[object Function]"},i=function(){return o(arguments)}();return o.isLegacyArguments=t,it=i?o:t,it}const Fa=Re(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var ut,lo;function Ne(){if(lo)return ut;lo=1;var n=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,r=n&&e&&typeof e.get=="function"?e.get:null,o=n&&Map.prototype.forEach,t=typeof Set=="function"&&Set.prototype,i=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=t&&i&&typeof i.get=="function"?i.get:null,a=t&&Set.prototype.forEach,f=typeof WeakMap=="function"&&WeakMap.prototype,c=f?WeakMap.prototype.has:null,v=typeof WeakSet=="function"&&WeakSet.prototype,p=v?WeakSet.prototype.has:null,y=typeof WeakRef=="function"&&WeakRef.prototype,g=y?WeakRef.prototype.deref:null,S=Boolean.prototype.valueOf,R=Object.prototype.toString,d=Function.prototype.toString,O=String.prototype.match,w=String.prototype.slice,b=String.prototype.replace,M=String.prototype.toUpperCase,Q=String.prototype.toLowerCase,G=RegExp.prototype.test,D=Array.prototype.concat,k=Array.prototype.join,I=Array.prototype.slice,_=Math.floor,U=typeof BigInt=="function"?BigInt.prototype.valueOf:null,N=Object.getOwnPropertySymbols,H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,V=typeof Symbol=="function"&&typeof Symbol.iterator=="object",K=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===V||!0)?Symbol.toStringTag:null,$e=Object.prototype.propertyIsEnumerable,we=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(s){return s.__proto__}:null);function ie(s,l){if(s===1/0||s===-1/0||s!==s||s&&s>-1e3&&s<1e3||G.call(/e/,l))return l;var C=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof s=="number"){var W=s<0?-_(-s):_(s);if(W!==s){var L=String(W),x=w.call(l,L.length+1);return b.call(L,C,"$&_")+"."+b.call(b.call(x,/([0-9]{3})/g,"$&_"),/_$/,"")}}return b.call(l,C,"$&_")}var z=Fa,Pe=z.custom,Be=E(Pe)?Pe:null,Ie={__proto__:null,double:'"',single:"'"},de={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};ut=function s(l,C,W,L){var x=C||{};if(F(x,"quoteStyle")&&!F(Ie,x.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(F(x,"maxStringLength")&&(typeof x.maxStringLength=="number"?x.maxStringLength<0&&x.maxStringLength!==1/0:x.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var me=F(x,"customInspect")?x.customInspect:!0;if(typeof me!="boolean"&&me!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(F(x,"indent")&&x.indent!==null&&x.indent!=="	"&&!(parseInt(x.indent,10)===x.indent&&x.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(F(x,"numericSeparator")&&typeof x.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var qe=x.numericSeparator;if(typeof l>"u")return"undefined";if(l===null)return"null";if(typeof l=="boolean")return l?"true":"false";if(typeof l=="string")return ve(l,x);if(typeof l=="number"){if(l===0)return 1/0/l>0?"0":"-0";var oe=String(l);return qe?ie(l,oe):oe}if(typeof l=="bigint"){var Se=String(l)+"n";return qe?ie(l,Se):Se}var Wt=typeof x.depth>"u"?5:x.depth;if(typeof W>"u"&&(W=0),W>=Wt&&Wt>0&&typeof l=="object")return T(l)?"[Array]":"[Object]";var Te=gi(x,W);if(typeof L>"u")L=[];else if(fe(L,l)>=0)return"[Circular]";function ue(Me,ze,Si){if(ze&&(L=I.call(L),L.push(ze)),Si){var ya={depth:x.depth};return F(x,"quoteStyle")&&(ya.quoteStyle=x.quoteStyle),s(Me,ya,W+1,L)}return s(Me,x,W+1,L)}if(typeof l=="function"&&!B(l)){var ia=ge(l),ua=Ge(l,ue);return"[Function"+(ia?": "+ia:" (anonymous)")+"]"+(ua.length>0?" { "+k.call(ua,", ")+" }":"")}if(E(l)){var fa=V?b.call(String(l),/^(Symbol\(.*\))_[^)]*$/,"$1"):H.call(l);return typeof l=="object"&&!V?he(fa):fa}if(He(l)){for(var De="<"+Q.call(String(l.nodeName)),Lt=l.attributes||[],Ke=0;Ke<Lt.length;Ke++)De+=" "+Lt[Ke].name+"="+h(m(Lt[Ke].value),"double",x);return De+=">",l.childNodes&&l.childNodes.length&&(De+="..."),De+="</"+Q.call(String(l.nodeName))+">",De}if(T(l)){if(l.length===0)return"[]";var Ut=Ge(l,ue);return Te&&!di(Ut)?"["+Nt(Ut,Te)+"]":"[ "+k.call(Ut,", ")+" ]"}if(j(l)){var Ht=Ge(l,ue);return!("cause"in Error.prototype)&&"cause"in l&&!$e.call(l,"cause")?"{ ["+String(l)+"] "+k.call(D.call("[cause]: "+ue(l.cause),Ht),", ")+" }":Ht.length===0?"["+String(l)+"]":"{ ["+String(l)+"] "+k.call(Ht,", ")+" }"}if(typeof l=="object"&&me){if(Be&&typeof l[Be]=="function"&&z)return z(l,{depth:Wt-W});if(me!=="symbol"&&typeof l.inspect=="function")return l.inspect()}if(se(l)){var sa=[];return o&&o.call(l,function(Me,ze){sa.push(ue(ze,l,!0)+" => "+ue(Me,l))}),aa("Map",r.call(l),sa,Te)}if(pe(l)){var la=[];return a&&a.call(l,function(Me){la.push(ue(Me,l))}),aa("Set",u.call(l),la,Te)}if(te(l))return xe("WeakMap");if(ye(l))return xe("WeakSet");if(ce(l))return xe("WeakRef");if(q(l))return he(ue(Number(l)));if(J(l))return he(ue(U.call(l)));if(A(l))return he(S.call(l));if(P(l))return he(ue(String(l)));if(typeof window<"u"&&l===window)return"{ [object Window] }";if(typeof globalThis<"u"&&l===globalThis||typeof re<"u"&&l===re)return"{ [object globalThis] }";if(!$(l)&&!B(l)){var Gt=Ge(l,ue),ca=we?we(l)===Object.prototype:l instanceof Object||l.constructor===Object,Kt=l instanceof Object?"":"null prototype",pa=!ca&&K&&Object(l)===l&&K in l?w.call(ee(l),8,-1):Kt?"Object":"",mi=ca||typeof l.constructor!="function"?"":l.constructor.name?l.constructor.name+" ":"",zt=mi+(pa||Kt?"["+k.call(D.call([],pa||[],Kt||[]),": ")+"] ":"");return Gt.length===0?zt+"{}":Te?zt+"{"+Nt(Gt,Te)+"}":zt+"{ "+k.call(Gt,", ")+" }"}return String(l)};function h(s,l,C){var W=C.quoteStyle||l,L=Ie[W];return L+s+L}function m(s){return b.call(String(s),/"/g,"&quot;")}function T(s){return ee(s)==="[object Array]"&&(!K||!(typeof s=="object"&&K in s))}function $(s){return ee(s)==="[object Date]"&&(!K||!(typeof s=="object"&&K in s))}function B(s){return ee(s)==="[object RegExp]"&&(!K||!(typeof s=="object"&&K in s))}function j(s){return ee(s)==="[object Error]"&&(!K||!(typeof s=="object"&&K in s))}function P(s){return ee(s)==="[object String]"&&(!K||!(typeof s=="object"&&K in s))}function q(s){return ee(s)==="[object Number]"&&(!K||!(typeof s=="object"&&K in s))}function A(s){return ee(s)==="[object Boolean]"&&(!K||!(typeof s=="object"&&K in s))}function E(s){if(V)return s&&typeof s=="object"&&s instanceof Symbol;if(typeof s=="symbol")return!0;if(!s||typeof s!="object"||!H)return!1;try{return H.call(s),!0}catch{}return!1}function J(s){if(!s||typeof s!="object"||!U)return!1;try{return U.call(s),!0}catch{}return!1}var Y=Object.prototype.hasOwnProperty||function(s){return s in this};function F(s,l){return Y.call(s,l)}function ee(s){return R.call(s)}function ge(s){if(s.name)return s.name;var l=O.call(d.call(s),/^function\s*([\w$]+)/);return l?l[1]:null}function fe(s,l){if(s.indexOf)return s.indexOf(l);for(var C=0,W=s.length;C<W;C++)if(s[C]===l)return C;return-1}function se(s){if(!r||!s||typeof s!="object")return!1;try{r.call(s);try{u.call(s)}catch{return!0}return s instanceof Map}catch{}return!1}function te(s){if(!c||!s||typeof s!="object")return!1;try{c.call(s,c);try{p.call(s,p)}catch{return!0}return s instanceof WeakMap}catch{}return!1}function ce(s){if(!g||!s||typeof s!="object")return!1;try{return g.call(s),!0}catch{}return!1}function pe(s){if(!u||!s||typeof s!="object")return!1;try{u.call(s);try{r.call(s)}catch{return!0}return s instanceof Set}catch{}return!1}function ye(s){if(!p||!s||typeof s!="object")return!1;try{p.call(s,p);try{c.call(s,c)}catch{return!0}return s instanceof WeakSet}catch{}return!1}function He(s){return!s||typeof s!="object"?!1:typeof HTMLElement<"u"&&s instanceof HTMLElement?!0:typeof s.nodeName=="string"&&typeof s.getAttribute=="function"}function ve(s,l){if(s.length>l.maxStringLength){var C=s.length-l.maxStringLength,W="... "+C+" more character"+(C>1?"s":"");return ve(w.call(s,0,l.maxStringLength),l)+W}var L=de[l.quoteStyle||"single"];L.lastIndex=0;var x=b.call(b.call(s,L,"\\$1"),/[\x00-\x1f]/g,ke);return h(x,"single",l)}function ke(s){var l=s.charCodeAt(0),C={8:"b",9:"t",10:"n",12:"f",13:"r"}[l];return C?"\\"+C:"\\x"+(l<16?"0":"")+M.call(l.toString(16))}function he(s){return"Object("+s+")"}function xe(s){return s+" { ? }"}function aa(s,l,C,W){var L=W?Nt(C,W):k.call(C,", ");return s+" ("+l+") {"+L+"}"}function di(s){for(var l=0;l<s.length;l++)if(fe(s[l],`
`)>=0)return!1;return!0}function gi(s,l){var C;if(s.indent==="	")C="	";else if(typeof s.indent=="number"&&s.indent>0)C=k.call(Array(s.indent+1)," ");else return null;return{base:C,prev:k.call(Array(l+1),C)}}function Nt(s,l){if(s.length===0)return"";var C=`
`+l.prev+l.base;return C+k.call(s,","+C)+`
`+l.prev}function Ge(s,l){var C=T(s),W=[];if(C){W.length=s.length;for(var L=0;L<s.length;L++)W[L]=F(s,L)?l(s[L],s):""}var x=typeof N=="function"?N(s):[],me;if(V){me={};for(var qe=0;qe<x.length;qe++)me["$"+x[qe]]=x[qe]}for(var oe in s)F(s,oe)&&(C&&String(Number(oe))===oe&&oe<s.length||V&&me["$"+oe]instanceof Symbol||(G.call(/[^\w$]/,oe)?W.push(l(oe,s)+": "+l(s[oe],s)):W.push(oe+": "+l(s[oe],s))));if(typeof N=="function")for(var Se=0;Se<x.length;Se++)$e.call(s,x[Se])&&W.push("["+l(x[Se])+"]: "+l(s[x[Se]],s));return W}return ut}var ft,co;function Na(){if(co)return ft;co=1;var n=Ne(),e=ae(),r=function(a,f,c){for(var v=a,p;(p=v.next)!=null;v=p)if(p.key===f)return v.next=p.next,c||(p.next=a.next,a.next=p),p},o=function(a,f){if(a){var c=r(a,f);return c&&c.value}},t=function(a,f,c){var v=r(a,f);v?v.value=c:a.next={key:f,next:a.next,value:c}},i=function(a,f){return a?!!r(a,f):!1},u=function(a,f){if(a)return r(a,f,!0)};return ft=function(){var f,c={assert:function(v){if(!c.has(v))throw new e("Side channel does not contain "+n(v))},delete:function(v){var p=f&&f.next,y=u(f,v);return y&&p&&p===y&&(f=void 0),!!y},get:function(v){return o(f,v)},has:function(v){return i(f,v)},set:function(v,p){f||(f={next:void 0}),t(f,v,p)}};return c},ft}var st,po;function yo(){if(po)return st;po=1;var n=le(),e=Z(),r=Ne(),o=ae(),t=n("%Map%",!0),i=e("Map.prototype.get",!0),u=e("Map.prototype.set",!0),a=e("Map.prototype.has",!0),f=e("Map.prototype.delete",!0),c=e("Map.prototype.size",!0);return st=!!t&&function(){var p,y={assert:function(g){if(!y.has(g))throw new o("Side channel does not contain "+r(g))},delete:function(g){if(p){var S=f(p,g);return c(p)===0&&(p=void 0),S}return!1},get:function(g){if(p)return i(p,g)},has:function(g){return p?a(p,g):!1},set:function(g,S){p||(p=new t),u(p,g,S)}};return y},st}var lt,vo;function Wa(){if(vo)return lt;vo=1;var n=le(),e=Z(),r=Ne(),o=yo(),t=ae(),i=n("%WeakMap%",!0),u=e("WeakMap.prototype.get",!0),a=e("WeakMap.prototype.set",!0),f=e("WeakMap.prototype.has",!0),c=e("WeakMap.prototype.delete",!0);return lt=i?function(){var p,y,g={assert:function(S){if(!g.has(S))throw new t("Side channel does not contain "+r(S))},delete:function(S){if(i&&S&&(typeof S=="object"||typeof S=="function")){if(p)return c(p,S)}else if(o&&y)return y.delete(S);return!1},get:function(S){return i&&S&&(typeof S=="object"||typeof S=="function")&&p?u(p,S):y&&y.get(S)},has:function(S){return i&&S&&(typeof S=="object"||typeof S=="function")&&p?f(p,S):!!y&&y.has(S)},set:function(S,R){i&&S&&(typeof S=="object"||typeof S=="function")?(p||(p=new i),a(p,S,R)):o&&(y||(y=o()),y.set(S,R))}};return g}:o,lt}var ct,ho;function go(){if(ho)return ct;ho=1;var n=ae(),e=Ne(),r=Na(),o=yo(),t=Wa(),i=t||o||r;return ct=function(){var a,f={assert:function(c){if(!f.has(c))throw new n("Side channel does not contain "+e(c))},delete:function(c){return!!a&&a.delete(c)},get:function(c){return a&&a.get(c)},has:function(c){return!!a&&a.has(c)},set:function(c,v){a||(a=i()),a.set(c,v)}};return f},ct}var pt,mo;function La(){if(mo)return pt;mo=1;var n=Ur(),e=go()(),r=ae(),o={assert:function(t,i){if(!t||typeof t!="object"&&typeof t!="function")throw new r("`O` is not an object");if(typeof i!="string")throw new r("`slot` must be a string");if(e.assert(t),!o.has(t,i))throw new r("`"+i+"` is not present on `O`")},get:function(t,i){if(!t||typeof t!="object"&&typeof t!="function")throw new r("`O` is not an object");if(typeof i!="string")throw new r("`slot` must be a string");var u=e.get(t);return u&&u["$"+i]},has:function(t,i){if(!t||typeof t!="object"&&typeof t!="function")throw new r("`O` is not an object");if(typeof i!="string")throw new r("`slot` must be a string");var u=e.get(t);return!!u&&n(u,"$"+i)},set:function(t,i,u){if(!t||typeof t!="object"&&typeof t!="function")throw new r("`O` is not an object");if(typeof i!="string")throw new r("`slot` must be a string");var a=e.get(t);a||(a={},e.set(t,a)),a["$"+i]=u}};return Object.freeze&&Object.freeze(o),pt=o,pt}var yt,So;function Ua(){if(So)return yt;So=1;var n=La(),e=er(),r=typeof StopIteration=="object"?StopIteration:null;return yt=function(t){if(!r)throw new e("this environment lacks StopIteration");n.set(t,"[[Done]]",!1);var i={next:function(){var a=n.get(this,"[[Iterator]]"),f=!!n.get(a,"[[Done]]");try{return{done:f,value:f?void 0:a.next()}}catch(c){if(n.set(a,"[[Done]]",!0),c!==r)throw c;return{done:!0,value:void 0}}}};return n.set(i,"[[Iterator]]",t),i},yt}var vt,bo;function Oo(){if(bo)return vt;bo=1;var n={}.toString;return vt=Array.isArray||function(e){return n.call(e)=="[object Array]"},vt}var ht,Ao;function wo(){if(Ao)return ht;Ao=1;var n=Z(),e=n("String.prototype.valueOf"),r=function(a){try{return e(a),!0}catch{return!1}},o=n("Object.prototype.toString"),t="[object String]",i=Ae()();return ht=function(a){return typeof a=="string"?!0:!a||typeof a!="object"?!1:i?r(a):o(a)===t},ht}var dt,Po;function Io(){if(Po)return dt;Po=1;var n=typeof Map=="function"&&Map.prototype?Map:null,e=typeof Set=="function"&&Set.prototype?Set:null,r;n||(r=function(u){return!1});var o=n?Map.prototype.has:null,t=e?Set.prototype.has:null;return!r&&!o&&(r=function(u){return!1}),dt=r||function(u){if(!u||typeof u!="object")return!1;try{if(o.call(u),t)try{t.call(u)}catch{return!0}return u instanceof n}catch{}return!1},dt}var gt,qo;function Ro(){if(qo)return gt;qo=1;var n=typeof Map=="function"&&Map.prototype?Map:null,e=typeof Set=="function"&&Set.prototype?Set:null,r;e||(r=function(u){return!1});var o=n?Map.prototype.has:null,t=e?Set.prototype.has:null;return!r&&!t&&(r=function(u){return!1}),gt=r||function(u){if(!u||typeof u!="object")return!1;try{if(t.call(u),o)try{o.call(u)}catch{return!0}return u instanceof e}catch{}return!1},gt}var Eo;function Ha(){if(Eo)return Ce.exports;Eo=1;var n=so(),e=Ua();if(Rr()()||Fe()()){var r=Symbol.iterator;Ce.exports=function(I){if(I!=null&&typeof I[r]<"u")return I[r]();if(n(I))return Array.prototype[r].call(I)}}else{var o=Oo(),t=wo(),i=le(),u=i("%Map%",!0),a=i("%Set%",!0),f=Zn(),c=f("Array.prototype.push"),v=f("String.prototype.charCodeAt"),p=f("String.prototype.slice"),y=function(I,_){var U=I.length;if(_+1>=U)return _+1;var N=v(I,_);if(N<55296||N>56319)return _+1;var H=v(I,_+1);return H<56320||H>57343?_+1:_+2},g=function(I){var _=0;return{next:function(){var N=_>=I.length,H;return N||(H=I[_],_+=1),{done:N,value:H}}}},S=function(I,_){if(o(I)||n(I))return g(I);if(t(I)){var U=0;return{next:function(){var H=y(I,U),V=p(I,U,H);return U=H,{done:H>I.length,value:V}}}}if(_&&typeof I["_es6-shim iterator_"]<"u")return I["_es6-shim iterator_"]()};if(!u&&!a)Ce.exports=function(I){if(I!=null)return S(I,!0)};else{var R=Io(),d=Ro(),O=f("Map.prototype.forEach",!0),w=f("Set.prototype.forEach",!0);if(typeof process>"u"||!process.versions||!process.versions.node)var b=f("Map.prototype.iterator",!0),M=f("Set.prototype.iterator",!0);var Q=f("Map.prototype.@@iterator",!0)||f("Map.prototype._es6-shim iterator_",!0),G=f("Set.prototype.@@iterator",!0)||f("Set.prototype._es6-shim iterator_",!0),D=function(I){if(R(I)){if(b)return e(b(I));if(Q)return Q(I);if(O){var _=[];return O(I,function(N,H){c(_,[H,N])}),g(_)}}if(d(I)){if(M)return e(M(I));if(G)return G(I);if(w){var U=[];return w(I,function(N){c(U,N)}),g(U)}}};Ce.exports=function(I){return D(I)||S(I)}}}return Ce.exports}var mt,$o;function Bo(){if($o)return mt;$o=1;var n=function(e){return e!==e};return mt=function(r,o){return r===0&&o===0?1/r===1/o:!!(r===o||n(r)&&n(o))},mt}var St,xo;function To(){if(xo)return St;xo=1;var n=Bo();return St=function(){return typeof Object.is=="function"?Object.is:n},St}var bt,Mo;function Ga(){if(Mo)return bt;Mo=1;var n=To(),e=Oe();return bt=function(){var o=n();return e(Object,{is:o},{is:function(){return Object.is!==o}}),o},bt}var Ot,jo;function Ka(){if(jo)return Ot;jo=1;var n=Oe(),e=Ee(),r=Bo(),o=To(),t=Ga(),i=e(o(),Object);return n(i,{getPolyfill:o,implementation:r,shim:t}),Ot=i,Ot}var At,Co;function ko(){if(Co)return At;Co=1;var n=Ee(),e=Z(),r=le(),o=r("%ArrayBuffer%",!0),t=e("ArrayBuffer.prototype.byteLength",!0),i=e("Object.prototype.toString"),u=!!o&&!t&&new o(0).slice,a=!!u&&n(u);return At=t||a?function(c){if(!c||typeof c!="object")return!1;try{return t?t(c):a(c,0),!0}catch{return!1}}:o?function(c){return i(c)==="[object ArrayBuffer]"}:function(c){return!1},At}var wt,Do;function za(){if(Do)return wt;Do=1;var n=Z(),e=n("Date.prototype.getDay"),r=function(a){try{return e(a),!0}catch{return!1}},o=n("Object.prototype.toString"),t="[object Date]",i=Ae()();return wt=function(a){return typeof a!="object"||a===null?!1:i?r(a):o(a)===t},wt}var Pt,_o;function Fo(){if(_o)return Pt;_o=1;var n=Z(),e=Ae()(),r=Ur(),o=be(),t;if(e){var i=n("RegExp.prototype.exec"),u={},a=function(){throw u},f={toString:a,valueOf:a};typeof Symbol.toPrimitive=="symbol"&&(f[Symbol.toPrimitive]=a),t=function(y){if(!y||typeof y!="object")return!1;var g=o(y,"lastIndex"),S=g&&r(g,"value");if(!S)return!1;try{i(y,f)}catch(R){return R===u}}}else{var c=n("Object.prototype.toString"),v="[object RegExp]";t=function(y){return!y||typeof y!="object"&&typeof y!="function"?!1:c(y)===v}}return Pt=t,Pt}var It,No;function Va(){if(No)return It;No=1;var n=Z(),e=n("SharedArrayBuffer.prototype.byteLength",!0);return It=e?function(o){if(!o||typeof o!="object")return!1;try{return e(o),!0}catch{return!1}}:function(o){return!1},It}var qt,Wo;function Ja(){if(Wo)return qt;Wo=1;var n=Z(),e=n("Number.prototype.toString"),r=function(a){try{return e(a),!0}catch{return!1}},o=n("Object.prototype.toString"),t="[object Number]",i=Ae()();return qt=function(a){return typeof a=="number"?!0:!a||typeof a!="object"?!1:i?r(a):o(a)===t},qt}var Rt,Lo;function Ya(){if(Lo)return Rt;Lo=1;var n=Z(),e=n("Boolean.prototype.toString"),r=n("Object.prototype.toString"),o=function(a){try{return e(a),!0}catch{return!1}},t="[object Boolean]",i=Ae()();return Rt=function(a){return typeof a=="boolean"?!0:a===null||typeof a!="object"?!1:i&&Symbol.toStringTag in a?o(a):r(a)===t},Rt}var We={exports:{}},Et,Uo;function Xa(){if(Uo)return Et;Uo=1;var n=Z(),e=Fo(),r=n("RegExp.prototype.exec"),o=ae();return Et=function(i){if(!e(i))throw new o("`regex` must be a RegExp");return function(a){return r(i,a)!==null}},Et}var Ho;function Za(){if(Ho)return We.exports;Ho=1;var n=Z(),e=n("Object.prototype.toString"),r=Rr()(),o=Xa();if(r){var t=n("Symbol.prototype.toString"),i=o(/^Symbol\(.*\)$/),u=function(f){return typeof f.valueOf()!="symbol"?!1:i(t(f))};We.exports=function(f){if(typeof f=="symbol")return!0;if(!f||typeof f!="object"||e(f)!=="[object Symbol]")return!1;try{return u(f)}catch{return!1}}}else We.exports=function(f){return!1};return We.exports}var Le={exports:{}},$t,Go;function Qa(){if(Go)return $t;Go=1;var n=typeof BigInt<"u"&&BigInt;return $t=function(){return typeof n=="function"&&typeof BigInt=="function"&&typeof n(42)=="bigint"&&typeof BigInt(42)=="bigint"},$t}var Ko;function ei(){if(Ko)return Le.exports;Ko=1;var n=Qa()();if(n){var e=BigInt.prototype.valueOf,r=function(t){try{return e.call(t),!0}catch{}return!1};Le.exports=function(t){return t===null||typeof t>"u"||typeof t=="boolean"||typeof t=="string"||typeof t=="number"||typeof t=="symbol"||typeof t=="function"?!1:typeof t=="bigint"?!0:r(t)}}else Le.exports=function(t){return!1};return Le.exports}var Bt,zo;function ri(){if(zo)return Bt;zo=1;var n=wo(),e=Ja(),r=Ya(),o=Za(),t=ei();return Bt=function(u){if(u==null||typeof u!="object"&&typeof u!="function")return null;if(n(u))return"String";if(e(u))return"Number";if(r(u))return"Boolean";if(o(u))return"Symbol";if(t(u))return"BigInt"},Bt}var xt,Vo;function ti(){if(Vo)return xt;Vo=1;var n=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,e=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,r;n||(r=function(u){return!1});var o=n?n.prototype.has:null,t=e?e.prototype.has:null;return!r&&!o&&(r=function(u){return!1}),xt=r||function(u){if(!u||typeof u!="object")return!1;try{if(o.call(u,o),t)try{t.call(u,t)}catch{return!0}return u instanceof n}catch{}return!1},xt}var Ue={exports:{}},Jo;function ni(){if(Jo)return Ue.exports;Jo=1;var n=le(),e=Z(),r=n("%WeakSet%",!0),o=e("WeakSet.prototype.has",!0);if(o){var t=e("WeakMap.prototype.has",!0);Ue.exports=function(u){if(!u||typeof u!="object")return!1;try{if(o(u,o),t)try{t(u,t)}catch{return!0}return u instanceof r}catch{}return!1}}else Ue.exports=function(u){return!1};return Ue.exports}var Tt,Yo;function oi(){if(Yo)return Tt;Yo=1;var n=Io(),e=Ro(),r=ti(),o=ni();return Tt=function(i){if(i&&typeof i=="object"){if(n(i))return"Map";if(e(i))return"Set";if(r(i))return"WeakMap";if(o(i))return"WeakSet"}return!1},Tt}var Mt,Xo;function ai(){if(Xo)return Mt;Xo=1;var n=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,o;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw o}}),o={},e(function(){throw 42},null,r)}catch(w){w!==o&&(e=null)}else e=null;var t=/^\s*class\b/,i=function(b){try{var M=n.call(b);return t.test(M)}catch{return!1}},u=function(b){try{return i(b)?!1:(n.call(b),!0)}catch{return!1}},a=Object.prototype.toString,f="[object Object]",c="[object Function]",v="[object GeneratorFunction]",p="[object HTMLAllCollection]",y="[object HTML document.all class]",g="[object HTMLCollection]",S=typeof Symbol=="function"&&!!Symbol.toStringTag,R=!(0 in[,]),d=function(){return!1};if(typeof document=="object"){var O=document.all;a.call(O)===a.call(document.all)&&(d=function(b){if((R||!b)&&(typeof b>"u"||typeof b=="object"))try{var M=a.call(b);return(M===p||M===y||M===g||M===f)&&b("")==null}catch{}return!1})}return Mt=e?function(b){if(d(b))return!0;if(!b||typeof b!="function"&&typeof b!="object")return!1;try{e(b,null,r)}catch(M){if(M!==o)return!1}return!i(b)&&u(b)}:function(b){if(d(b))return!0;if(!b||typeof b!="function"&&typeof b!="object")return!1;if(S)return u(b);if(i(b))return!1;var M=a.call(b);return M!==c&&M!==v&&!/^\[object HTML/.test(M)?!1:u(b)},Mt}var jt,Zo;function ii(){if(Zo)return jt;Zo=1;var n=ai(),e=Object.prototype.toString,r=Object.prototype.hasOwnProperty,o=function(f,c,v){for(var p=0,y=f.length;p<y;p++)r.call(f,p)&&(v==null?c(f[p],p,f):c.call(v,f[p],p,f))},t=function(f,c,v){for(var p=0,y=f.length;p<y;p++)v==null?c(f.charAt(p),p,f):c.call(v,f.charAt(p),p,f)},i=function(f,c,v){for(var p in f)r.call(f,p)&&(v==null?c(f[p],p,f):c.call(v,f[p],p,f))},u=function(f,c,v){if(!n(c))throw new TypeError("iterator must be a function");var p;arguments.length>=3&&(p=v),e.call(f)==="[object Array]"?o(f,c,p):typeof f=="string"?t(f,c,p):i(f,c,p)};return jt=u,jt}var Ct,Qo;function ui(){return Qo||(Qo=1,Ct=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),Ct}var kt,ea;function fi(){if(ea)return kt;ea=1;var n=ui(),e=typeof globalThis>"u"?re:globalThis;return kt=function(){for(var o=[],t=0;t<n.length;t++)typeof e[n[t]]=="function"&&(o[o.length]=n[t]);return o},kt}var Dt,ra;function si(){if(ra)return Dt;ra=1;var n=ii(),e=fi(),r=Ee(),o=Z(),t=be(),i=o("Object.prototype.toString"),u=Ae()(),a=typeof globalThis>"u"?re:globalThis,f=e(),c=o("String.prototype.slice"),v=Object.getPrototypeOf,p=o("Array.prototype.indexOf",!0)||function(d,O){for(var w=0;w<d.length;w+=1)if(d[w]===O)return w;return-1},y={__proto__:null};u&&t&&v?n(f,function(R){var d=new a[R];if(Symbol.toStringTag in d){var O=v(d),w=t(O,Symbol.toStringTag);if(!w){var b=v(O);w=t(b,Symbol.toStringTag)}y["$"+R]=r(w.get)}}):n(f,function(R){var d=new a[R],O=d.slice||d.set;O&&(y["$"+R]=r(O))});var g=function(d){var O=!1;return n(y,function(w,b){if(!O)try{"$"+w(d)===b&&(O=c(b,1))}catch{}}),O},S=function(d){var O=!1;return n(y,function(w,b){if(!O)try{w(d),O=c(b,1)}catch{}}),O};return Dt=function(d){if(!d||typeof d!="object")return!1;if(!u){var O=c(i(d),8,-1);return p(f,O)>-1?O:O!=="Object"?!1:S(d)}return t?g(d):null},Dt}var _t,ta;function li(){if(ta)return _t;ta=1;var n=Z(),e=n("ArrayBuffer.prototype.byteLength",!0),r=ko();return _t=function(t){return r(t)?e?e(t):t.byteLength:NaN},_t}var Ft,na;function ci(){if(na)return Ft;na=1;var n=ja(),e=Zn(),r=_a(),o=le(),t=Ha(),i=go(),u=Ka(),a=so(),f=Oo(),c=ko(),v=za(),p=Fo(),y=Va(),g=Xe(),S=ri(),R=oi(),d=si(),O=li(),w=e("SharedArrayBuffer.prototype.byteLength",!0),b=e("Date.prototype.getTime"),M=Object.getPrototypeOf,Q=e("Object.prototype.toString"),G=o("%Set%",!0),D=e("Map.prototype.has",!0),k=e("Map.prototype.get",!0),I=e("Map.prototype.size",!0),_=e("Set.prototype.add",!0),U=e("Set.prototype.delete",!0),N=e("Set.prototype.has",!0),H=e("Set.prototype.size",!0);function V(h,m,T,$){for(var B=t(h),j;(j=B.next())&&!j.done;)if(z(m,j.value,T,$))return U(h,j.value),!0;return!1}function K(h){if(typeof h>"u")return null;if(typeof h!="object")return typeof h=="symbol"?!1:typeof h=="string"||typeof h=="number"?+h==+h:!0}function $e(h,m,T,$,B,j){var P=K(T);if(P!=null)return P;var q=k(m,P),A=n({},B,{strict:!1});return typeof q>"u"&&!D(m,P)||!z($,q,A,j)?!1:!D(h,P)&&z($,q,A,j)}function we(h,m,T){var $=K(T);return $??(N(m,$)&&!N(h,$))}function ie(h,m,T,$,B,j){for(var P=t(h),q,A;(q=P.next())&&!q.done;)if(A=q.value,z(T,A,B,j)&&z($,k(m,A),B,j))return U(h,A),!0;return!1}function z(h,m,T,$){var B=T||{};if(B.strict?u(h,m):h===m)return!0;var j=S(h),P=S(m);if(j!==P)return!1;if(!h||!m||typeof h!="object"&&typeof m!="object")return B.strict?u(h,m):h==m;var q=$.has(h),A=$.has(m),E;if(q&&A){if($.get(h)===$.get(m))return!0}else E={};return q||$.set(h,E),A||$.set(m,E),de(h,m,B,$)}function Pe(h){return!h||typeof h!="object"||typeof h.length!="number"||typeof h.copy!="function"||typeof h.slice!="function"||h.length>0&&typeof h[0]!="number"?!1:!!(h.constructor&&h.constructor.isBuffer&&h.constructor.isBuffer(h))}function Be(h,m,T,$){if(H(h)!==H(m))return!1;for(var B=t(h),j=t(m),P,q,A;(P=B.next())&&!P.done;)if(P.value&&typeof P.value=="object")A||(A=new G),_(A,P.value);else if(!N(m,P.value)){if(T.strict||!we(h,m,P.value))return!1;A||(A=new G),_(A,P.value)}if(A){for(;(q=j.next())&&!q.done;)if(q.value&&typeof q.value=="object"){if(!V(A,q.value,T.strict,$))return!1}else if(!T.strict&&!N(h,q.value)&&!V(A,q.value,T.strict,$))return!1;return H(A)===0}return!0}function Ie(h,m,T,$){if(I(h)!==I(m))return!1;for(var B=t(h),j=t(m),P,q,A,E,J,Y;(P=B.next())&&!P.done;)if(E=P.value[0],J=P.value[1],E&&typeof E=="object")A||(A=new G),_(A,E);else if(Y=k(m,E),typeof Y>"u"&&!D(m,E)||!z(J,Y,T,$)){if(T.strict||!$e(h,m,E,J,T,$))return!1;A||(A=new G),_(A,E)}if(A){for(;(q=j.next())&&!q.done;)if(E=q.value[0],Y=q.value[1],E&&typeof E=="object"){if(!ie(A,h,E,Y,T,$))return!1}else if(!T.strict&&(!h.has(E)||!z(k(h,E),Y,T,$))&&!ie(A,h,E,Y,n({},T,{strict:!1}),$))return!1;return H(A)===0}return!0}function de(h,m,T,$){var B,j;if(typeof h!=typeof m||h==null||m==null||Q(h)!==Q(m)||a(h)!==a(m))return!1;var P=f(h),q=f(m);if(P!==q)return!1;var A=h instanceof Error,E=m instanceof Error;if(A!==E||(A||E)&&(h.name!==m.name||h.message!==m.message))return!1;var J=p(h),Y=p(m);if(J!==Y||(J||Y)&&(h.source!==m.source||r(h)!==r(m)))return!1;var F=v(h),ee=v(m);if(F!==ee||(F||ee)&&b(h)!==b(m)||T.strict&&M&&M(h)!==M(m))return!1;var ge=d(h),fe=d(m);if(ge!==fe)return!1;if(ge||fe){if(h.length!==m.length)return!1;for(B=0;B<h.length;B++)if(h[B]!==m[B])return!1;return!0}var se=Pe(h),te=Pe(m);if(se!==te)return!1;if(se||te){if(h.length!==m.length)return!1;for(B=0;B<h.length;B++)if(h[B]!==m[B])return!1;return!0}var ce=c(h),pe=c(m);if(ce!==pe)return!1;if(ce||pe)return O(h)!==O(m)?!1:typeof Uint8Array=="function"&&z(new Uint8Array(h),new Uint8Array(m),T,$);var ye=y(h),He=y(m);if(ye!==He)return!1;if(ye||He)return w(h)!==w(m)?!1:typeof Uint8Array=="function"&&z(new Uint8Array(h),new Uint8Array(m),T,$);if(typeof h!=typeof m)return!1;var ve=g(h),ke=g(m);if(ve.length!==ke.length)return!1;for(ve.sort(),ke.sort(),B=ve.length-1;B>=0;B--)if(ve[B]!=ke[B])return!1;for(B=ve.length-1;B>=0;B--)if(j=ve[B],!z(h[j],m[j],T,$))return!1;var he=R(h),xe=R(m);return he!==xe?!1:he==="Set"||xe==="Set"?Be(h,m,T,$):he==="Map"?Ie(h,m,T,$):!0}return Ft=function(m,T,$){return z(m,T,$,i())},Ft}var pi=ci();const yi=ne(pi);class oa{constructor(e){this.target=e,this.isContentEditable=e&&e.contentEditable}getPos(){if(document.activeElement!==this.target)return-1;if(this.isContentEditable==="true"){this.target.focus();let e=document.getSelection().getRangeAt(0),r=e.cloneRange();return r.selectNodeContents(this.target),r.setEnd(e.endContainer,e.endOffset),r.toString().length}return this.target.selectionStart}setPos(e){if(this.isContentEditable==="true"){if(e>=0){var r=window.getSelection(),o=this.createRange(this.target,{count:e});o&&(o.collapse(!1),r.removeAllRanges(),r.addRange(o))}}else this.target.setSelectionRange(e,e)}createRange(e,r,o){if(o||(o=document.createRange(),o.selectNode(e),o.setStart(e,0)),r.count===0)o.setEnd(e,r.count);else if(e&&r.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<r.count?r.count-=e.textContent.length:(o.setEnd(e,r.count),r.count=0);else for(var t=0;t<e.childNodes.length&&(o=this.createRange(e.childNodes[t],r,o),r.count!==0);t++);return o}}class vi{constructor(e,r,o){X(this,"debounceTimer");X(this,"holder");X(this,"mutationDebouncer");X(this,"observer");this.holder=r,this.observer=null,this.debounceTimer=o,this.mutationDebouncer=this.debounce(()=>{e()},this.debounceTimer)}setMutationObserver(){const e={childList:!0,attributes:!0,subtree:!0,characterData:!0,characterDataOldValue:!0},r=this.holder.querySelector(".codex-editor__redactor");this.observer=new MutationObserver(o=>{this.mutationHandler(o)}),this.observer.observe(r,e)}mutationHandler(e){let r=!1;e.forEach(o=>{switch(o.type){case"childList":o.target===this.holder?this.onDestroy():r=!0;break;case"characterData":r=!0;break;case"attributes":o.target instanceof Element&&!o.target.classList.contains("ce-block")&&!o.target.classList.contains("tc-toolbox")&&(r=!0);break}}),r&&this.mutationDebouncer()}debounce(e,r){let o;return(...t)=>{const i=this;window.clearTimeout(o),o=window.setTimeout(()=>e.apply(i,t),r)}}onDestroy(){const e=new CustomEvent("destroy");document.dispatchEvent(e),this.observer!=null&&this.observer.disconnect()}}class hi{constructor({editor:e,config:r={},onUpdate:o,maxLength:t}){X(this,"blocks");X(this,"caret");X(this,"config");X(this,"defaultBlock");X(this,"editor");X(this,"holder");X(this,"initialItem");X(this,"maxLength");X(this,"onUpdate");X(this,"position",0);X(this,"readOnly");X(this,"shouldSaveHistory");X(this,"stack",[]);const i={maxLength:30,onUpdate(){},config:{debounceTimer:200,shortcuts:{undo:["CMD+Z"],redo:["CMD+Y","CMD+SHIFT+Z"]}}},u=e,{blocks:a,caret:f}=u,{configuration:c}=u,{holder:v,defaultBlock:p}=c,y=i.config.shortcuts,{shortcuts:g}=r,S={...y,...g},R=Array.isArray(S.undo)?S.undo:[S.undo],d=Array.isArray(S.redo)?S.redo:[S.redo],O=i.config.debounceTimer,{debounceTimer:w=O}=r;this.holder=typeof v=="string"?document.getElementById(v):v,this.editor=u,this.defaultBlock=p,this.blocks=a,this.caret=f,this.shouldSaveHistory=!0,this.readOnly=c.readOnly,this.maxLength=t||i.maxLength,this.onUpdate=o||i.onUpdate,this.config={debounceTimer:w,shortcuts:{undo:R,redo:d}},this.holder&&new vi(()=>this.registerChange(),this.holder,this.config.debounceTimer).setMutationObserver(),this.setEventListeners(),this.initialItem=null,this.clear()}static get isReadOnlySupported(){return!0}truncate(e,r){for(;e.length>r;)e.shift()}initialize(e){const r="blocks"in e?e.blocks:e,t={index:r.length-1,state:r};this.stack[0]=t,this.initialItem=t}clear(){this.stack=this.initialItem?[this.initialItem]:[{index:0,state:[{type:this.defaultBlock,data:{}}]}],this.position=0,this.onUpdate()}setReadOnly(){var r;const e=(r=this.holder)==null?void 0:r.querySelector(".ce-toolbox");this.readOnly=!e}registerChange(){this.setReadOnly(),this.readOnly||(this.editor&&this.editor.save&&this.shouldSaveHistory&&this.editor.save().then(e=>{this.editorDidUpdate(e.blocks)&&this.save(e.blocks)}),this.shouldSaveHistory=!0)}editorDidUpdate(e){const{state:r}=this.stack[this.position];return e.length?e.length!==r.length?!0:JSON.stringify(r)!==JSON.stringify(e):!1}save(e){this.position>=this.maxLength&&this.truncate(this.stack,this.maxLength),this.position=Math.min(this.position,this.stack.length-1),this.stack=this.stack.slice(0,this.position+1);const r=this.blocks.getCurrentBlockIndex(),o=this.blocks.getBlocksCount();let t=r;e[r]||(t-=o-e.length);const i=e[t]&&(e[t].type==="paragraph"||e[t].type==="header")?this.getCaretIndex(r):null;this.stack.push({index:t,state:e,caretIndex:i}),this.position+=1,this.onUpdate()}getCaretIndex(e){var o;const r=(o=this.holder)==null?void 0:o.getElementsByClassName("ce-block__content");return r?new oa(r[e].firstChild).getPos():null}async undo(){if(this.canUndo()){const{state:e}=this.stack[this.position];this.position-=1,this.shouldSaveHistory=!1;const{caretIndex:r,index:o,state:t}=this.stack[this.position];await this.switchState(t,e),this.onUpdate(),this.blocks.getBlockByIndex(o)&&(r?this.setCaretIndex(o,r):this.caret.setToBlock(o,"end"))}}setCaretIndex(e,r){var t;const o=(t=this.holder)==null?void 0:t.getElementsByClassName("ce-block__content");if(r&&r!==-1&&o){const i=new oa(o[e].firstChild);setTimeout(()=>i.setPos(r),50)}else this.caret.setToBlock(e,"end")}insertBlock(e,r){this.blocks.insert(e[r].type,e[r].data,{},r,!0)}async updateModifiedBlock(e,r){const o=e[r];return o.id&&this.editor.blocks.getById(o.id)?this.blocks.update(o.id,o.data,o.tunes):this.blocks.render({blocks:e})}async redo(){if(this.canRedo()){this.position+=1,this.shouldSaveHistory=!1;const{caretIndex:e,index:r,state:o}=this.stack[this.position],{state:t}=this.stack[this.position-1];await this.switchState(o,t),this.onUpdate(),this.blocks.getBlockByIndex(r)&&(e?this.setCaretIndex(r,e):this.caret.setToBlock(r,"end"))}}async switchState(e,r){r.reduce((t,i,u)=>e.find(a=>a.id===i.id)?t:[...t,u],[]).sort((t,i)=>i-t).forEach(t=>this.blocks.delete(t)),e.reduce((t,i,u)=>r.find(a=>a.id===i.id)?t:[...t,u],[]).forEach(t=>this.insertBlock(e,t));const o=e.reduce((t,i,u)=>{const a=r.findIndex(f=>f.id===i.id);return a>-1&&!yi(i,r[a])?[...t,u]:t},[]);await Promise.all(o.map(async t=>await this.updateModifiedBlock(e,t)))}canUndo(){return!this.readOnly&&this.position>0}canRedo(){return!this.readOnly&&this.position<this.count()}count(){return this.stack.length-1}parseKeys(e){const r={CMD:/(Mac)/i.test(navigator.platform)?"metaKey":"ctrlKey",ALT:"altKey",SHIFT:"shiftKey"},o=e.slice(0,-1).map(i=>r[i]),t=o.includes("shiftKey")&&e.length===2?e[e.length-1].toUpperCase():e[e.length-1].toLowerCase();return o.push(t),o}setEventListeners(){const{holder:e}=this,{shortcuts:r}=this.config,{redo:o,undo:t}=r,i=t.map(d=>d.replace(/ /g,"").split("+")),u=o.map(d=>d.replace(/ /g,"").split("+")),a=i.map(d=>this.parseKeys(d)),f=u.map(d=>this.parseKeys(d)),c=(d,O)=>O.length===2&&d[O[0]]&&d.key.toLowerCase()===O[1],v=(d,O)=>O.length===3&&d[O[0]]&&d[O[1]]&&d.key.toLowerCase()===O[2],p=(d,O)=>O.reduce((w,b)=>w||c(d,b),!1),y=(d,O)=>O.reduce((w,b)=>w||v(d,b),!1),g=(d,O,w)=>!!(p(d,O)&&!y(d,w)||y(d,O)),S=d=>{g(d,a,f)&&(d.preventDefault(),this.undo())},R=d=>{g(d,f,a)&&(d.preventDefault(),this.redo())};if(e){const d=()=>{e.removeEventListener("keydown",S),e.removeEventListener("keydown",R)};e.addEventListener("keydown",S),e.addEventListener("keydown",R),e.addEventListener("destroy",d)}}}return hi});
